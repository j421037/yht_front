webpackJsonp([61],{"4k9M":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o={data:function(){return{Form:{version_id:"",discount:"",category:"",product_brand:"",operate:1,new_version:"",remark:""},Rules:{version_id:[{required:!0,trigger:"blur",message:"请选择价格版本"}],discount:[{required:!0,trigger:"blur",message:"请输入调价幅度"}],category:[{required:!0,trigger:"blur",message:"请选择产品"}],product_brand:[{required:!0,trigger:"blur",message:"请选择品牌"}],operate:[{required:!0,trigger:"blur",message:"请选择调整的方向"}],remark:[{required:!0,trigger:"blur",message:"请输入调价信息"}]},submiting:!1,remoteLoading:!1,mode:0}},methods:{handleOpen:function(){},handleClose:function(){this.$store.dispatch("SetBaseProductConfig",{field:"Price.FastPriceMaintenance.visible",value:!1}),this.$refs.form.resetFields()},handleCategoryChange:function(){this.Form.product_brand=""},handleBrandChange:function(e){var r=this;this.remoteLoading=!0,this.$store.dispatch("ProductPriceVersion",{product_brand:e}).then(function(){r.remoteLoading=!1}),this.product_brands.forEach(function(t){t.value==e&&(r.mode=t.mode)})},submit:function(){var e=this;this.$refs.form.validate(function(r){r&&(e.submiting=!0,e.$store.dispatch("ProductPriceFastUpdate",e.Form).then(function(){"success"==e.$store.state.user.ProductPriceFastUpdate.status?(e.$notify.success("操作成功"),e.$store.dispatch("ProductSurfacePriceList",{id:e.Form.product_brand})):e.$notify.error("操作失败,请检查"),e.submiting=!1}))})},validateVersion:function(e,r,t){/^[A-Za-z0-9_\.]*$/.test(r)?t():t(new Error("只允许输入字母、数字、破折号（ - ）以及下划线（ _ ）"))}},computed:{visible:function(){return this.$store.state.user.BaseProduct.Price.FastPriceMaintenance.visible},categorys:function(){var e=[];return this.$store.state.user.ProductCategoryList.forEach(function(r){e.push({label:r.name,value:r.id})}),e},product_brands:function(){var e=this,r=[],t=[];return this.$store.state.user.ProductCategoryList.forEach(function(r){r.id==e.Form.category&&(t=r.children)}),t.forEach(function(e){r.push({label:e.name,value:e.id,mapping:e.fields.mapping,mode:e.method})}),r},PriceVersions:function(){var e=this,r=[];return this.$store.state.user.ProductPriceVersion.forEach(function(t){t.product_brand==e.Form.product_brand&&(r=t.rows)}),r},operates:function(){return[{label:"上浮",value:1},{label:"下跌",value:0}]}}},a={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"fastMaintenance-wallpaper"},[t("el-dialog",{attrs:{title:"一键调价",visible:e.visible,"before-close":e.handleClose,width:"30%"},on:{"update:visible":function(r){e.visible=r},open:e.handleOpen}},[t("el-form",{ref:"form",attrs:{model:e.Form,rules:e.Rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"产品分类",prop:"category"}},[t("el-select",{on:{change:e.handleCategoryChange},model:{value:e.Form.category,callback:function(r){e.$set(e.Form,"category",r)},expression:"Form.category"}},e._l(e.categorys,function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"品牌",prop:"product_brand"}},[t("el-select",{on:{change:e.handleBrandChange},model:{value:e.Form.product_brand,callback:function(r){e.$set(e.Form,"product_brand",r)},expression:"Form.product_brand"}},e._l(e.product_brands,function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"价格版本",prop:"version_id"}},[t("el-select",{attrs:{loading:e.remoteLoading},model:{value:e.Form.version_id,callback:function(r){e.$set(e.Form,"version_id",r)},expression:"Form.version_id"}},e._l(e.PriceVersions,function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"新版本号",prop:"new_version",rules:[{validator:e.validateVersion,trigger:"blur"},{required:!0,trigger:"blur",message:"请输入版本号"}]}},[t("el-input",{attrs:{placeholder:"请输入新的版本号"},model:{value:e.Form.new_version,callback:function(r){e.$set(e.Form,"new_version",r)},expression:"Form.new_version"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"操作",prop:"operate"}},[t("el-select",{model:{value:e.Form.operate,callback:function(r){e.$set(e.Form,"operate",r)},expression:"Form.operate"}},e._l(e.operates,function(e,r){return t("el-option",{key:r,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"值",prop:"discount"}},[t("el-input",{attrs:{placeholder:"请输入调价的金额或者折扣幅度,整数"},model:{value:e.Form.discount,callback:function(r){e.$set(e.Form,"discount",r)},expression:"Form.discount"}},[1==e.mode?t("template",{slot:"append"},[e._v("元")]):e._e(),e._v(" "),0==e.mode?t("template",{slot:"append"},[e._v("百分点")]):e._e()],2)],1),e._v(" "),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{placeholder:"请输入调价的信息"},model:{value:e.Form.remark,callback:function(r){e.$set(e.Form,"remark",r)},expression:"Form.remark"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.submiting},nativeOn:{click:function(r){return e.submit(r)}}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[]};var n=t("VU/8")(o,a,!1,function(e){t("FLGj")},null,null);r.default=n.exports},FLGj:function(e,r){}});