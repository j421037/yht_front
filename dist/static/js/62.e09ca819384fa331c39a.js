webpackJsonp([62],{"0p9L":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){return{Form:{category:"",product_brand:""},historyVisible:!1,historyLoading:!0,viewPriceBtnDisable:!0,standardPriceVisible:!1,standardLoading:!0}},methods:{handleClose:function(){this.$store.dispatch("SetBaseProductConfig",{field:"Price.History.visible",value:!1})},handleOpen:function(){this.LoadPriceInfo()},LoadPriceInfo:function(){this.$store.dispatch("LoadPriceInfo",this.Form)},handleProductChange:function(t){this.LoadPriceInfo(),this.viewPriceBtnDisable=!t},ViewPriceFile:function(t){window.open(this.$appConst.BASEURL+"attr/preview?token="+this.$store.state.user.token+"&id="+t,"newwindow","height=500,width=700")},ViewHistoryPrice:function(t){var e=this;this.historyVisible=!0,this.historyLoading=!0,this.$store.dispatch("LoadHistoryPrices",{vid:t}).then(function(){return e.historyLoading=!1})},ViewStandardPrice:function(){this.standardPriceVisible=!0},HanleViewStandardOpen:function(){var t=this;this.standardLoading=!0,this.$store.dispatch("LoadStandardPrice",this.Form).then(function(){t.standardLoading=!1})}},computed:{visible:function(){return this.$store.state.user.BaseProduct.Price.History.visible},priceInfo:function(){return this.$store.state.user.priceInfo},historyTabColumn:function(){return this.$store.state.user.LoadHistoryPrices.column},historyTabData:function(){return this.$store.state.user.LoadHistoryPrices.rows},standardTabColumn:function(){return this.$store.state.user.LoadStandardPrice.column},standardTabData:function(){return this.$store.state.user.LoadStandardPrice.rows},categorys:function(){var t=[];return this.$store.state.user.ProductCategoryList.forEach(function(e){t.push({label:e.name,value:e.id})}),t},product_brands:function(){var t=this,e=[],i=[];return this.$store.state.user.ProductCategoryList.forEach(function(e){e.id==t.Form.category&&(i=e.children)}),i.forEach(function(t){e.push({label:t.name,value:t.id})}),e.length>0&&e.push({label:"全部",value:null}),e}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"history-wallpaper"},[i("el-dialog",{staticClass:"cost-price-history_dialog",attrs:{title:"调价历史",visible:t.visible,"before-close":t.handleClose,width:"40%"},on:{"update:visible":function(e){t.visible=e},open:t.handleOpen}},[i("el-form",{attrs:{model:t.Form,"label-width":"80px",inline:""}},[i("el-form-item",{attrs:{label:"产品分类"}},[i("el-select",{model:{value:t.Form.category,callback:function(e){t.$set(t.Form,"category",e)},expression:"Form.category"}},t._l(t.categorys,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"品牌"}},[i("el-select",{on:{change:t.handleProductChange},model:{value:t.Form.product_brand,callback:function(e){t.$set(t.Form,"product_brand",e)},expression:"Form.product_brand"}},t._l(t.product_brands,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),i("el-button",{staticStyle:{margin:"0px 0px 10px 80px"},attrs:{type:"success",disabled:t.viewPriceBtnDisable},nativeOn:{click:function(e){return t.ViewStandardPrice(e)}}},[t._v("查看基准面价")]),t._v(" "),t._l(t.priceInfo,function(e,a){return i("el-timeline",{key:a},[i("el-timeline-item",{attrs:{timestamp:e.date,placement:"top",icon:"el-icon-more",color:"rgb(11, 189, 135)"}},[i("el-card",[i("div",[i("section",[i("h4",[t._v(t._s(e.category_name)+" - "+t._s(e.brand_name))]),t._v(" "),i("el-table",{attrs:{data:e.data,width:"200",border:""}},[i("el-table-column",{attrs:{label:"运费",prop:"freight"}}),t._v(" "),i("el-table-column",{attrs:{label:"备注",prop:"remark"}}),t._v(" "),i("el-table-column",{attrs:{label:"走势"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.change_val?i("div",[e.row.operate?i("span",[t._v("上调")]):i("span",[t._v("下浮")]),t._v(" "),i("span",[t._v(t._s(e.row.change_val))])]):t._e()]}}])})],1)],1),t._v(" "),i("section",{staticStyle:{"margin-top":"10px"}},[i("el-button",{attrs:{type:"danger"},on:{click:function(i){t.ViewHistoryPrice(e.id)}}},[t._v("查看本次价格")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(i){t.ViewPriceFile(e.id)}}},[t._v("厂家面价表")])],1)])])],1)],1)})],2),t._v(" "),i("el-dialog",{staticClass:"cost-price-history_dialog",attrs:{title:"历史价格",visible:t.historyVisible,width:"70%"},on:{"update:visible":function(e){t.historyVisible=e}}},[i("el-alert",{attrs:{title:this.$store.state.user.LoadHistoryPrices.notice,closable:!1,type:"warning"}}),t._v(" "),i("el-table",{staticStyle:{"margin-top":"8px"},attrs:{data:t.historyTabData,border:"",height:"350"}},t._l(t.historyTabColumn,function(t,e){return i("el-table-column",{key:e,attrs:{label:t.label,prop:t.value}})}))],1),t._v(" "),i("el-dialog",{staticClass:"cost-price-history_dialog",attrs:{title:"基准面价",visible:t.standardPriceVisible,width:"70%"},on:{"update:visible":function(e){t.standardPriceVisible=e},open:t.HanleViewStandardOpen}},[i("el-alert",{attrs:{title:this.$store.state.user.LoadStandardPrice.notice,closable:!1,type:"success"}}),t._v(" "),i("el-table",{staticStyle:{"margin-top":"8px"},attrs:{data:t.standardTabData,border:"",height:"350"}},t._l(t.standardTabColumn,function(t,e){return i("el-table-column",{key:e,attrs:{label:t.label,prop:t.value}})}))],1)],1)},staticRenderFns:[]};var n=i("VU/8")(a,r,!1,function(t){i("fdGF")},null,null);e.default=n.exports},fdGF:function(t,e){}});