webpackJsonp([16],{"oM+D":function(t,e){},oluQ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-wapper"},[s("div",{staticClass:"role-wapper"},[s("div",{staticClass:"tool"},[s("el-button",{attrs:{type:"success",loading:t.syncBtnLoading},on:{click:t.syncUserList}},[t._v("同步企业微信通讯录")]),t._v(" "),s("span",{staticStyle:{"font-size":"12px","vertical-align":"bottom","line-height":"1","margin-left":"10px"}},[t._v("上一次同步的时间: "+t._s(t.initData.sync_date))])],1),t._v(" "),s("div",{staticClass:"table-wapper"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":"550"}},[s("el-table-column",{attrs:{prop:"id",label:"id",width:"50"}}),t._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"department",label:"部门"}}),t._v(" "),s("el-table-column",{attrs:{prop:"role",label:"所拥有的角色",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.role,function(e){return s("span",{style:{"padding-left":"5px"}},[s("el-tag",{attrs:{type:"success",size:"medium"}},[t._v(t._s(e.label))])],1)})}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"date",label:"注册时间"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置角色",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(s){t.handleEditRole(e.row)}}},[s("i",{staticClass:"el-icon-edit-outline"})])],1),t._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"加入企业微信",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"primary",disabled:0!=e.row.workwx},on:{click:function(s){t.handleJoinWorkWx(e.row)}}},[s("i",{staticClass:" iconfont icon-qiyeweixin"})])],1),t._v(" "),s("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:0==e.row.authorize,expression:"scope.row.authorize == 0"}],staticClass:"item",attrs:{effect:"dark",content:"通过审核",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(s){t.handleAuthorize(e.row)}}},[s("i",{staticClass:"iconfont icon-weibiaoti--"})])],1),t._v(" "),s("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:1==e.row.authorize,expression:"scope.row.authorize == 1"}],staticClass:"item",attrs:{effect:"dark",content:"禁用",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"danger",disabled:"admin"==e.row.username},on:{click:function(s){t.handleDisable(e.row)}}},[s("i",{staticClass:"el-icon-delete"})])],1)]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:"分配角色",visible:t.setRoleVisible,center:"",width:"30%"},on:{"update:visible":function(e){t.setRoleVisible=e},close:t.closeDialog}},[s("div",{staticClass:"role-list"},t._l(this.$store.state.user.userRole,function(e){return s("el-checkbox",{key:e.id,attrs:{label:e.name},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"item.checked"}})})),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",loading:t.setRoleLoding},nativeOn:{click:function(e){return t.saveRole(e)}}},[t._v("确 定")]),t._v(" "),s("el-button",{on:{click:function(e){t.setRoleVisible=!1}}},[t._v("取 消")])],1)])],1)])])},staticRenderFns:[]};var o=s("VU/8")({data:function(){return{tableLoading:!0,setRoleVisible:!1,roleData:{id:"",rid:[]},setRoleLoding:!1,syncBtnLoading:!1}},methods:{handleAuthorize:function(t){var e=this;this.$confirm("授权 <"+t.username+" >登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("updateUserAuthorize",{id:t.id}).then(function(){"success"==e.$store.state.user.updateUserAuthorize.status?(e.$notify.success({title:"操作成功",message:"用户已授权"}),e.initable()):e.$notify({title:"操作失败",message:e.$store.state.user.updateUserAuthorize.error})})}).catch(function(){})},handleEditRole:function(t){var e=this;this.roleData.id=t.id,this.$store.dispatch("getUserRole",t.id).then(function(){e.setRoleVisible=!0})},saveRole:function(){var t=this,e=this.$store.state.user.userRole;for(var s in this.roleData.rid=[],this.setRoleLoding=!0,e)!0===e[s].checked&&this.roleData.rid.push(e[s].id);this.$store.dispatch("putUserRole",this.roleData).then(function(e){t.setRoleLoding=!1,"success"==t.$store.state.user.user_put_role_status.status?t.$message.success("用户角色分配成功！"):t.$message.error(t.$store.state.user.user_put_role_status),t.setRoleVisible=!1})},handleDisable:function(t){},closeDialog:function(){this.initable()},initable:function(){var t=this;this.tableLoading=!0,this.$store.dispatch("getUserList").then(function(){t.tableLoading=!1})},syncUserList:function(){var t=this;this.syncBtnLoading=!0,this.$store.dispatch("syncUser").then(function(){"success"==t.$store.state.user.syncUser.status?(t.$notify.success("操作成功"),t.initable(),t.syncBtnLoading=!1):t.$notify.error({title:"操作失败",message:t.$store.state.user.syncUser.error})})},handleJoinWorkWx:function(t){var e=this;this.$confirm("将<"+t.username+">加入企业微信?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){e.joinWorkWx(t)}).catch(function(){})},joinWorkWx:function(t){var e=this;this.$store.dispatch("joinWorkWx",{id:t.id}).then(function(t){(e.$store.state.user.joinWorkWx.status="success")?(e.$notify.success("操作成功"),e.initable()):e.$notify.error({title:"操作失败",message:e.$store.state.user.joinWorkWx.error})})},initUserList:function(){this.$store.dispatch("initUserList").then(function(){})}},computed:{tableData:function(){return this.$store.state.user.userList},initData:function(){return this.$store.state.user.initUserList}},created:function(){this.initable(),this.initUserList()}},i,!1,function(t){s("oM+D")},"data-v-7bc9765c",null);e.default=o.exports}});