webpackJsonp([37],{G6Fh:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={data:function(){return{CustomerType:"未验收",total:0,loading:!0,pdVisible:!1,customer:{},manual:0}},created:function(){},methods:{refresh:function(){++this.manual},query:function(t){var e=this;this.loading=!0,t.accept="未验收"==this.CustomerType?0:1,this.$store.dispatch("getPersonalCustomer",t).then(function(){e.loading=!1,console.log(e.customers)})},CustomerChange:function(){++this.manual},accept:function(t){var e=this;this.currentClickIndex=0,1==this.mobile?this.$dialog.confirm({message:"验收客户 <"+t.name+">, 该客户将纳入你的名下,确定进行该操作 ?"}).then(function(){e.submitAccept(t)}).catch(function(){}):this.$confirm("验收客户 <"+t.name+">, 该客户将纳入你的名下,确定进行该操作 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){e.submitAccept(t)}).catch(function(){})},submitAccept:function(t){var e=this;this.$store.dispatch("acceptCustomer",{id:t.id}).then(function(){"success"==e.$store.state.user.acceptCustomer.status?(e.$notify.success({title:"操作成功",message:"客户<"+t.name+"> 已验收"}),++e.manual):e.$notify.error({title:"操作失败",message:e.$store.state.user.acceptCustomer.error})})},free:function(t){var e=this;this.$prompt("请输入释放理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[\w|\u4e00-\u9fa5]{5,}.*$/,inputErrorMessage:"内容不能少于5个字符"}).then(function(s){var n=s.value;e.submitFree({id:t.id,reason:n,name:t.name})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},submitFree:function(t){var e=this;this.$store.dispatch("freeCustomer",t).then(function(){"success"==e.$store.state.user.freeCustomer.status?e.$notify.success({title:"操作成功",message:"客户<"+t.name+">已经释放"}):e.$notify.error({title:"操作失败",mesage:e.$store.state.user.freeCustomer.error})})},initComments:function(t){var e=this;this.$store.dispatch("getComments",{id:t,offset:0,limit:15}).then(function(){e.trackLoading=!1})},submitFllowForm:function(){var t=this;if(""==this.trackComment)return!1;this.$store.dispatch("appendComments",{content:this.trackComment,customer_id:this.currentItem.id}).then(function(){"success"==t.$store.state.user.append_comments.status?(t.$notify.success({title:"操作成功",message:"记录已添加"}),t.trackComment="",t.initComments(t.currentItem.id)):t.$notify.error({title:"操作失败",message:t.$store.state.user.append_comments.error})})},upgrade:function(t){this.pdVisible=!0,this.customer=t}},computed:{customers:function(){var t=this.$store.state.user.personal_customer_list;return this.total=t.total,t.data},comments:function(){return this.$store.state.user.comments.data},ReceiveNum:function(){return this.$store.state.user.personal_customer_list.count},AcceptNum:function(){return this.$store.state.user.personal_customer_list.accept}},components:{project:function(){return s.e(54).then(s.bind(null,"6S4Z"))},pagination:function(){return s.e(53).then(s.bind(null,"g32C"))}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mycustomer"},[s("el-radio-group",{on:{change:t.CustomerChange},model:{value:t.CustomerType,callback:function(e){t.CustomerType=e},expression:"CustomerType"}},[s("el-radio-button",{attrs:{label:"未验收"}}),t._v(" "),s("el-radio-button",{attrs:{label:"已验收"}})],1),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-top":"15px"},attrs:{data:t.customers,border:"",strip:""}},[s("el-table-column",{attrs:{type:"index"}}),t._v(" "),s("el-table-column",{attrs:{label:"客户",prop:"name",width:"120"}}),t._v(" "),s("el-table-column",{attrs:{label:"联系方式"}},[s("el-table-column",{attrs:{label:"电话",prop:"phone"}}),t._v(" "),s("el-table-column",{attrs:{label:"微信",prop:"wechat"}}),t._v(" "),s("el-table-column",{attrs:{label:"QQ",prop:"qq"}})],1),t._v(" "),s("el-table-column",{attrs:{label:"项目名",prop:"project_name"}}),t._v(" "),t._e(),t._v(" "),s("el-table-column",{attrs:{label:"需求",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-popover",{attrs:{placement:"top-start",title:"需求",width:"200",trigger:"hover",content:e.row.demand}},[e.row.demand?s("a",{attrs:{slot:"reference",href:"javascript:void(0)"},slot:"reference"},[t._v(t._s(e.row.demand.substring(0,20))+"...")]):t._e()])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?[s("span",[t._v(t._s(e.row.status))])]:[0==e.row.accept?s("span",[s("el-tag",{attrs:{type:"warning"}},[t._v("未验收")])],1):s("span",[s("el-tag",{attrs:{type:"success"}},[t._v("已验收")])],1)]]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"更新日期",prop:"action_date"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.accept?[s("el-button-group",[s("el-button",{attrs:{type:"success",size:"mini"},nativeOn:{click:function(s){t.accept(e.row)}}},[t._v("验收")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"mini"},nativeOn:{click:function(s){t.free(e.row)}}},[t._v("释放")])],1)]:t._e(),t._v(" "),1!=e.row.accept||e.row.status?t._e():[s("el-button",{attrs:{type:"success",size:"mini"},nativeOn:{click:function(s){t.upgrade(e.row)}}},[t._v("升级客户")])]]}}])})],1),t._v(" "),s("project",{attrs:{visible:t.pdVisible,customer:t.customer},on:{close:function(e){t.pdVisible=!1},refresh:t.refresh}}),t._v(" "),s("pagination",{attrs:{total:t.total,handle:t.query,refresh:t.manual}})],1)},staticRenderFns:[]};var o=s("VU/8")(n,r,!1,function(t){s("ydfD")},"data-v-331f8bab",null);e.default=o.exports},ydfD:function(t,e){}});